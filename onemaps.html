<!DOCTYPE html>
<html>

<head>
    <title>OneMap Static Map Example</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        #map {
            width: 100%;
            height: 400px;
        }
    </style>
</head>

<body>
    <!-- <div id="result"></div> -->
    <div id="map"></div>
    

    <script>
        var startlat;
        var startlng;

        function initMap() {
            
            // startlat= '1.31955';
            // startlng = '103.84223';
            var endlat = '1.31801';
            var endlng = '103.84224';

            var mapDiv = document.getElementById('map');
            var mapUrl = 'https://developers.onemap.sg/commonapi/staticmap/getStaticImage?layerchosen=default&';

            var lat = '1.31955';
            var lng = '103.84223';
            var zoom = '17';
            var height = '512';
            var width = '512';
            var startpoint = '[' + startlat + ',' + startlng + ',"255,255,178","B"]';
            var endpoint = '[' + endlat + ',' + endlng + ',"175,50,0","A"]';
            // var startpoint = '[1.31955,103.84223,"255,255,178","B"]';
            // var endpoint = '[1.31801,103.84224,"175,50,0","A"]';
            var imageUrl = mapUrl + 'lat=' + lat + '&lng=' + lng + '&zoom=' + zoom + '&height=' + height + '&width=' + width + '&ploygons=' + '&lines=' + '&points=' + startpoint + '|' + endpoint;

            // var imageUrl = 'https://developers.onemap.sg/commonapi/staticmap/getStaticImage?layerchosen=default&lat=1.31955&lng=103.84223&zoom=17&height=512&width=512&polygons=&lines=&points=[1.31955,103.84223,"255,255,178","B"]|[1.31801,103.84224,"175,50,0","A"]&color=&fillColor=';
            // document.writeln(imageUrl);
            var mapImg = document.createElement('img');
            mapImg.src = imageUrl;

            mapDiv.appendChild(mapImg);
        }
    </script>

    <script>
        // 当页面加载完成后执行
        $(document).ready(function () {
            var location = "Singapore";

            // 调用API的端点URL
            var apiUrl = "https://developers.onemap.sg/";

            // 构建API请求URL
            var requestUrl = apiUrl + "commonapi/search?searchVal=" + location + "&returnGeom=Y&getAddrDetails=N";

            // 发送GET请求
            $.get(requestUrl, function (data) {
                // 提取LATITUDE和LONGITUDE信息
                startlat = data.results[0].LATITUDE;
                startlng = data.results[0].LONGITUDE;

                // var resultText = "Latitude: " + latitude + "<br>Longitude: " + longitude;
                // $("#result").html(resultText);
                initMap();
            });
        });
    </script>

   <!-- <script>
        window.addEventListener('DOMContentLoaded', initMap);
    </script>  -->
</body>

</html>